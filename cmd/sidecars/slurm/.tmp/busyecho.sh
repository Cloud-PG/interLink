#!/bin/bash
#SBATCH --job-name=busyecho
#SBATCH -A
#SBATCH INF22_lhc_0
#SBATCH 
#SBATCH --job-name=TEST_KNOC
#SBATCH -p
#SBATCH m100_usr_prod
#SBATCH -t
#SBATCH 1440
#SBATCH --gres="gpu:0"
#SBATCH --cpus-per-task=1
. ~/.bash_profile
module load singularity
export SINGULARITYENV_SINGULARITY_TMPDIR=$CINECA_SCRATCH
export SINGULARITYENV_SINGULARITY_CACHEDIR=$CINECA_SCRATCH
pwd; hostname; date

singularity exec  --env KUBERNETES_PORT=tcp://10.43.0.1:443,KUBERNETES_SERVICE_PORT_HTTPS=443,SADASD_PREDICTOR_DEFAULT_00001_SERVICE_PORT=80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT=tcp://10.43.215.150:80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9091_TCP=tcp://10.43.215.150:9091,KUBERNETES_SERVICE_HOST=10.43.0.1,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9090_TCP=tcp://10.43.215.150:9090,KSERVEUI_SERVICE_PORT_3000_TCP=tcp://10.43.183.175:3000,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTP_QUEUEADM=8022,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_80_TCP_PORT=80,SADASD_PREDICTOR_DEFAULT_00001_SERVICE_PORT_HTTP=80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_80_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_HOST=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PORT_443_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PORT_443_TCP=tcp://10.43.107.203:443,SADASD_PREDICTOR_DEFAULT_00001_SERVICE_HOST=10.43.107.203,KSERVEUI_SERVICE_PORT_3000_TCP_PORT=3000,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8022_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8012_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8012_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT=80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8022_TCP=tcp://10.43.215.150:8022,KSERVEUI_SERVICE_PORT=tcp://10.43.183.175:3000,KUBERNETES_SERVICE_PORT=443,SADASD_PREDICTOR_DEFAULT_00001_SERVICE_PORT_HTTPS=443,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9090_TCP_PROTO=tcp,KUBERNETES_PORT_443_TCP_PORT=443,SADASD_PREDICTOR_DEFAULT_00001_PORT_80_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8022_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_443_TCP_PORT=443,SADASD_PREDICTOR_DEFAULT_00001_PORT_80_TCP_ADDR=10.43.107.203,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9091_TCP_PORT=9091,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTP=80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTP_ISTIO=8012,KSERVEUI_SERVICE_SERVICE_HOST=10.43.183.175,KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443,KUBERNETES_PORT_443_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9091_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PORT_443_TCP_PORT=443,KSERVEUI_SERVICE_PORT_3000_TCP_PROTO=tcp,KSERVEUI_SERVICE_PORT_3000_TCP_ADDR=10.43.183.175,SADASD_PREDICTOR_DEFAULT_00001_PORT=tcp://10.43.107.203:80,KSERVEUI_SERVICE_SERVICE_PORT=3000,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_443_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_443_TCP_PROTO=tcp,SADASD_PREDICTOR_DEFAULT_00001_PORT_80_TCP=tcp://10.43.107.203:80,SADASD_PREDICTOR_DEFAULT_00001_PORT_443_TCP_ADDR=10.43.107.203,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8012_TCP_PORT=8012,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9090_TCP_PORT=9090,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_443_TCP=tcp://10.43.215.150:443,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9091_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_80_TCP=tcp://10.43.215.150:80,KUBERNETES_PORT_443_TCP_ADDR=10.43.0.1,SADASD_PREDICTOR_DEFAULT_00001_PORT_80_TCP_PORT=80,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTP_AUTOMETRIC=9090,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_9090_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTP_USERMETRIC=9091,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_80_TCP_ADDR=10.43.215.150,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_SERVICE_PORT_HTTPS=443,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8012_TCP=tcp://10.43.215.150:8012,SADASD_PREDICTOR_DEFAULT_00001_PRIVATE_PORT_8022_TCP_PORT=8022 busybox /m100/home/userexternal/gsurace0/script.sh >> .knoc/busyecho.out 2>> .knoc/busyecho.err 
 echo $? > .knoc/busyecho.status